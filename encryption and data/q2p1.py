import base64
import requests
import json
import libsodium
import nacl.secret
import nacl.utils
import random

token = "35d15be0f7cb11c2d0e9548ce2c9246b9148bf53d0587d764821c0c33a8a86ae"
reciever = "Muffin"
URL = "https://hash-browns.cs.uwaterloo.ca/api/psk/send"
message = b"Frou Frou Foxes in Midsummer Fires"
key = b'\x86\x2b\x6c\xa4\x17\xc9\x5e\x23\xe8\x36\x59\x50\x3e\x4c\xb3\x07\xfb\xfa\xcc\x93\x70\x65\x86\x05\x95\x31\x4b\xc0\xac\xb8\x05\xa8'
box = nacl.secret.SecretBox(key)
encrypted = str(base64.b64encode(box.encrypt(message)))[2:-1]
r = requests.post(
    url=URL,
    headers={"Content-Type":"application/json", "Accept":"application/json"}, 
    json={
        "api_token": token,
        "recipient": reciever,
        "msg": encrypted
        }
    )
print(f"Status Code: {r.status_code}, Response: {r.json()}")
