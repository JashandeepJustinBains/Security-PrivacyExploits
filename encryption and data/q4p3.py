import base64
import requests
import json
import libsodium
import nacl.secret
import nacl.utils
import nacl.hash
import nacl.encoding
from nacl.public import PrivateKey, Box
import random

token = "35d15be0f7cb11c2d0e9548ce2c9246b9148bf53d0587d764821c0c33a8a86ae"
skme = nacl.public.PrivateKey(b'x\x07\xb12\x1e^[d\xc1E\xd0\xf0\xcdp\xe2\xa8sp\x91\x89n\x0ba\x0f\xf2\x1c\x02\x1e\xb8\x801\xab')
pkMuffin = nacl.public.PublicKey(base64.b64decode(b'vWhPR97fZ2we2hkcGIkpmxVLjBysWtKjJjbV/sody0A='))
Muffin_box = Box(skme, pkMuffin)

r = requests.post(
    url="https://hash-browns.cs.uwaterloo.ca/api/pke/inbox",
    headers={"Content-Type":"application/json", "Accept":"application/json"}, 
    json={
        "api_token": token,
        }
    )
print(f"Status Code: {r.status_code}, Response: {r.json()}")
response = json.loads(r.content)[0]['msg']
print(response)
msg = base64.b64decode(response)
print(Muffin_box.decrypt(msg))